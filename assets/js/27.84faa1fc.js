(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{541:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"html语义化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#html语义化"}},[t._v("#")]),t._v(" HTML语义化")]),t._v(" "),a("ul",[a("li",[t._v("增加代码可读性，让开发者更好地理解；")]),t._v(" "),a("li",[t._v("能让搜索引擎更容易读懂，有助于爬虫爬取更多有效信息，有利于SEO；")]),t._v(" "),a("li",[t._v("在没有CSS样式下，页面也能呈现出更好地内容结构、代码结构；")]),t._v(" "),a("li",[t._v("方便视力不好人员浏览网页，可以通过阅读屏幕的方式阅读。")])]),t._v(" "),a("h2",{attrs:{id:"script标签中defer和async"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script标签中defer和async"}},[t._v("#")]),t._v(" script标签中defer和async")]),t._v(" "),a("p",[t._v("由于script标签会阻塞HTML解析，只有下载好并执行完脚本之后才会继续解析HTML。如果某个脚本的网络请求时间太长，或者JS脚本执行时间过长，都会导致页面白屏，用户看不到内容，于是出现了defer 和 async两个属性。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("async")]),t._v(": 解析HTML过程中进行脚本的异步下载，下载成功立即执行，有可能阻断HTML解析；")])]),t._v(" "),a("p",[t._v("当浏览器遇到带有async属性的script时，请求该脚本的网络请求是异步的，不会阻塞浏览器解析HTML，一旦网络请求回来之后，如果此时HTML还没有解析完，浏览器会暂停解析，现在JS引擎执行代码，代码执行完毕之后再进行解析，如图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/021b5dbeddb64db0a7099dc0a4dd076d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"async script"}})]),t._v(" "),a("p",[t._v("但是，如果在JS脚本请求回来之前，HTML已经解析完毕了，那也就不会阻塞HTML解析啦，会立即执行JS，如图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e5a89a4a1fe49ed9d5acaf25ef9aadd~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"async script"}})]),t._v(" "),a("p",[t._v("缺点：async属性是不可控的，因为该script标签请求到的网络资源依赖于网络传输的快慢，哪个脚本先获取到哪个就先执行；多个async脚本执行顺序不确定；因此如果在该异步JS脚本中获取某个DOM元素，有可能获取得到，也有可能获取不到。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("defer")]),t._v("：完全不会阻碍HTML的解析，解析完成之后再按照顺序执行脚本。")])]),t._v(" "),a("p",[t._v("当浏览器遇到带有defer属性的脚本时，获取该脚本的网络请求也是异步的，不会阻塞浏览器解析HTML，即使网络请求回来之后，如果此时HTML还没有解析完，浏览器也不会暂停解析并执行JS代码，而是等待HTML解析完毕再执行JS代码，如图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8313e4787f04c79838fec9961bda0fb~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"defer script"}})]),t._v(" "),a("p",[t._v("优点：如果存在多个defer script标签，浏览器会保证它们按照在HTML中出现的顺序执行，不会破坏JS脚本之前的依赖。、")]),t._v(" "),a("p",[t._v("使用场景：")]),t._v(" "),a("ul",[a("li",[t._v("推荐如果可以使用async，则优先使用async，然后是defer，最后才是不设置任何属性；")]),t._v(" "),a("li",[t._v("如果脚本是模块化的，并且不依赖其他任何脚本，可以使用async；")]),t._v(" "),a("li",[t._v("如果脚本依赖于另外一个脚本，推荐使用defer；")]),t._v(" "),a("li",[t._v("如果脚本很小，并且依赖于异步脚本，可以使用内联脚本，不用使用任何属性。")])]),t._v(" "),a("h2",{attrs:{id:"url全过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url全过程"}},[t._v("#")]),t._v(" url全过程")]),t._v(" "),a("h3",{attrs:{id:"_1-url解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-url解析"}},[t._v("#")]),t._v(" 1. url解析")]),t._v(" "),a("p",[t._v("浏览器对url解析出协议、主机、端口、路径等信息，构造出一个HTTP请求。")]),t._v(" "),a("h4",{attrs:{id:"_1-1-http请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-http请求"}},[t._v("#")]),t._v(" 1.1 HTTP请求")]),t._v(" "),a("p",[t._v("HTTP请求包含三个部分：请求行、请求头和请求体。")]),t._v(" "),a("ul",[a("li",[t._v("请求行包括：请求方法、请求路径、所用的协议版本")]),t._v(" "),a("li",[t._v("请求头：键值对的信息")]),t._v(" "),a("li",[t._v("请求体：请求的主体信息")])]),t._v(" "),a("p",[t._v("请求方法包括：GET、POST、HEAD、PUT、TRACE、DELETE、OPTIONS")]),t._v(" "),a("p",[t._v("关于状态码："),a("a",{attrs:{href:"https://simonzhangs.github.io/pages/261545/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP常见状态码"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("关于HTTPS协议：采用对称加密和非对称加密两种方式结合，客户端第一次请求的时候，服务端将证书的公钥传给客户端，客户端验证证书的合法性后，客户端产生随机数，并采用证书的公钥加密发回去，服务端采用自己的私钥解出来，随后用解出来的密钥进行对称加密通信。")]),t._v(" "),a("ol",[a("li",[t._v("为什么用非对称加密传输密钥：非对称加密只作用在证书验证阶段，防止中间人截获；")])]),t._v(" "),a("p",[t._v("什么是中间人攻击？简单来说就是，中间人截获客户端发送的消息，并返回给客户端中间人证书，然后获取到客户端的密钥；接着中间人再利用此信息和服务端进行通信，可以通过密钥得到传回给客户端的消息。所以通过证书来验证合法性防止中间人攻击。")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("为什么用对称加密进行内容传输：非对称加密的解密效率非常低，消息传输交互大，需要提高效率；而且私钥只保存在服务端，一对公私钥只能实现单向的加解密，服务端又不是只给你一个人服务。")])]),t._v(" "),a("p",[t._v("关于HTTP协议发展史：")]),t._v(" "),a("p",[t._v("HTTP1.0：")]),t._v(" "),a("ul",[a("li",[t._v("浏览器与服务器只保持短暂的链接，每次请求都需要建立一个TCP连接，服务器完成请求处理后立刻断开TCP连接；")]),t._v(" "),a("li",[t._v("出现的问题：当网页中包含多个图片链接、JS文件、CSS文件时，会频繁进行TCP连接与断开；")]),t._v(" "),a("li",[t._v("缺点：连接无法复用，浏览器对于同一个域名，同时只能有4个连接，超过后续请求会被阻塞；")])]),t._v(" "),a("p",[t._v("HTTP1.1：")]),t._v(" "),a("ul",[a("li",[t._v("增加管线化技术，允许客户端不用等到服务器响应就能发送下一个请求；目的是为了在一次TCP连接上可以并发多个请求，来提高网络利用率；")]),t._v(" "),a("li",[t._v("缺点：服务器必须按照请求的顺序来响应，即后续请求的响应必须等到第一个响应发送之后才能发生（HTTP队头阻塞）")]),t._v(" "),a("li",[t._v("HTTP对头阻塞解决：并发链接；域名分片；")])]),t._v(" "),a("p",[t._v("HTTP2.0：")]),t._v(" "),a("ul",[a("li",[t._v("增加了一层二进制分帧层，消息可以分为多帧，利用一个TCP连接中可以用多个帧流，但是仍然无法解决TCP队头阻塞。")])]),t._v(" "),a("p",[t._v("HTTP1.0 vs HTTP1.1：")]),t._v(" "),a("ul",[a("li",[t._v("支持持久连接，一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟；默认开启Connection：keep-alive；")]),t._v(" "),a("li",[t._v("允许客户端不必等待上一次请求结果返回，就可以发出下一次请求；")]),t._v(" "),a("li",[t._v("缓存处理，增加ETag/If-None-Match字段；")]),t._v(" "),a("li",[t._v("带宽优化以及网络链接优化，即206部分资源请求")])]),t._v(" "),a("p",[t._v("HTTP1.1 vs HTTP2.0")]),t._v(" "),a("ul",[a("li",[t._v("对于请求头的压缩：客户端与服务端之间建立哈希表，只传索引；对于整数和字符串进行哈夫曼编码；")]),t._v(" "),a("li",[t._v("多路复用；")]),t._v(" "),a("li",[t._v("二进制分帧；")]),t._v(" "),a("li",[t._v("服务器推送（埋坑：与preload、prefetch有关系嘛？）")])]),t._v(" "),a("h4",{attrs:{id:"_1-2-强缓存与协商缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-强缓存与协商缓存"}},[t._v("#")]),t._v(" 1.2 强缓存与协商缓存")]),t._v(" "),a("p",[t._v("根据构造的HTTP请求，浏览器会判断该请求信息是否在浏览器端存在缓存，从而加快资源获取速度，提升用户体验，减少网络传输，缓解服务端压力。")]),t._v(" "),a("p",[t._v("哪么，浏览器怎么判断是否存在缓存呢？首先需要说明的是浏览器存在两者HTTP缓存：强缓存和协商缓存。")]),t._v(" "),a("p",[t._v("关于强缓存，不需要发送请求到服务端，直接读取浏览器本地缓存，HTTP状态码是200；强缓存是由Expires、Cache-Control和Pragma 3个Header属性共同来控制。")]),t._v(" "),a("p",[a("code",[t._v("Expires")]),t._v(":浏览器在发起请求时，会判断系统时间和"),a("code",[t._v("Expires")]),t._v("值进行比较，如果系统时间超过Expires的值，则缓存失效。由于系统时间有可能和服务器时间不一致，会有缓存有效期不准的问题，优先级最低。")]),t._v(" "),a("p",[a("code",[t._v("Cache-Control")]),t._v("：HTTP/1.1中新增的属性，常见的属性值有：")]),t._v(" "),a("ul",[a("li",[t._v("max-age：单位为秒，距离发起的时间的秒数，超过间隔的秒数缓存失效")]),t._v(" "),a("li",[t._v("no-cache：不使用强缓存，需要与服务器验证缓存是否新鲜")]),t._v(" "),a("li",[t._v("no-store：禁止是同缓存，包括协商缓存")]),t._v(" "),a("li",[t._v("private：专用与个人的缓存，中间代理、CDN等不能缓存此响应")]),t._v(" "),a("li",[t._v("public：响应可以被中间代理、CDN缓存")]),t._v(" "),a("li",[t._v("must-revalidate：在缓存过期前可以使用，过期后必须向服务器验证")])]),t._v(" "),a("p",[a("code",[t._v("Pragma")]),t._v("：只有no-cache属性值，不使用强缓存，需要与服务器验证缓存是否新鲜，优先级最高")]),t._v(" "),a("p",[t._v("关于协商缓存，当浏览器的强制缓存失效或者请求头中设置了no-cache，并且在请求头中设置了If-Modified-Since或者If-None-Match的时候，会将这两个属性值到服务端去验证是否命中协商缓存，如果命中了协商缓存，返回304状态码，加载浏览器缓存，并且响应头会设置Last-Modified或者ETag属性。")]),t._v(" "),a("p",[a("code",[t._v("Etag/If-None-Match")]),t._v(":是一串hash值，代表的是一个资源的标识符，当服务端的文件变化的时候，它的hash码会随之变化，通过请求头中的If-None-Match和当前文件的hash值进行比较，如果相等则表示命中协商缓存。Etag有强弱校验之分，如果是弱校验，只有服务器上的文件差异（根据Etag计算方式来决定）达到能够触发hash值后缀变化的时候，才会真正地请求资源，否则返回304并加载浏览器缓存。")]),t._v(" "),a("p",[a("code",[t._v("Last-Modified/If-Modified-Since")]),t._v(":该值代表的是文件的最后修改时间，第一次请求服务端会把资源的最后修改时间放到Last-Modified响应头中，第二次发起请求的时候，请求头会带上上一次响应头中的Last-Modified的时间，并放到If-Modified-Since请求头属性中，服务端根据文件最后一次修改时间和If-Modified-SInce的值进行比较，如果相等返回304，并加载浏览器缓存。")]),t._v(" "),a("p",[a("code",[t._v("Etag/If-None-Match")]),t._v("的出现解决了"),a("code",[t._v("Last-Modified/If-Modified-Since")]),t._v("解决不了的问题：")]),t._v(" "),a("ul",[a("li",[t._v("如果文件的修改频率过快，"),a("code",[t._v("Last-Modified/If-Modified-Since")]),t._v("会错误地返回304，因为来不及不对服务器端修改的时间；")]),t._v(" "),a("li",[t._v("如果文件被修改了，但是内容没有任何改变时，"),a("code",[t._v("Last-Modified/If-Modified-Since")]),t._v("会错误返回304。")])]),t._v(" "),a("h3",{attrs:{id:"_2-dns域名解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-dns域名解析"}},[t._v("#")]),t._v(" 2. DNS域名解析")]),t._v(" "),a("p",[t._v("DNS域名解析分为递归查询和迭代查询两种方式。解析流程是：先查看本地hosts文件是否有映射，然后去查本地DNS服务器，如果没有委托本地服务器去根DNS、顶级域名服务器、再到权威域名服务器查询。可以通过DNS缓存、DNS负载均衡、DNS预解析技术优化。")]),t._v(" "),a("h3",{attrs:{id:"_3-tcp连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-tcp连接"}},[t._v("#")]),t._v(" 3. TCP连接")]),t._v(" "),a("p",[t._v("在经过DNS域名解析之后，浏览器拿到了目的IP地址，然后经过传输层的TCP协议，将请求报文进行TCP头封装，分成适合TCP传输的TCP段，TCP报文中包含与服务端连接的状态信息、端口号，源IP和目的IP地址等，在进行网络层IP头封装和网络接口层的MAC头封装，进行与服务器连接。通过TCP三次握手建立可靠连接，从而进行后续的资源请求。")]),t._v(" "),a("p",[t._v("为什么要进行三次握手呢？因为TCP为了建立可靠连接，需要保证客户端和服务端接收和发送能力。第一次握手可以确定客户端的发送能力，第二次握手来确定服务端的发送能力和接收能力，第三次握手才可以确定客户端的接收能力，从而减少丢包的现象。")]),t._v(" "),a("p",[t._v("如果只进行两次握手的话，第一次握手之后，第二次握手的请求在网络传输时间过长，从而客户端重新进行握手建立连接之后，上一次的握手响应被客户端接收到，会导致资源请求混乱。")]),t._v(" "),a("h3",{attrs:{id:"_4-http请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-http请求"}},[t._v("#")]),t._v(" 4. HTTP请求")]),t._v(" "),a("h3",{attrs:{id:"_5-服务器处理请求并返回http报文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-服务器处理请求并返回http报文"}},[t._v("#")]),t._v(" 5. 服务器处理请求并返回HTTP报文")]),t._v(" "),a("h3",{attrs:{id:"_6-浏览器渲染页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-浏览器渲染页面"}},[t._v("#")]),t._v(" 6. 浏览器渲染页面")]),t._v(" "),a("p",[t._v("根据HTTP返回的报文进行页面的渲染，渲染过程可以参考："),a("a",{attrs:{href:"https://www.songbenblog.com/pages/9d17c9/#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器渲染"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77972f24d69243bb93679f155f305095~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"浏览器渲染页面"}})]),t._v(" "),a("p",[t._v("注意页面渲染过程中JS阻塞问题，还有关于重绘和重排的问题及优化。")]),t._v(" "),a("p",[t._v("关于页面渲染优化：")]),t._v(" "),a("ul",[a("li",[t._v("HTML文档结构层次尽量少，最好不深于6层")]),t._v(" "),a("li",[t._v("脚本尽量后放，或者异步执行")]),t._v(" "),a("li",[t._v("在JS脚本中尽量减少DOM操作，尽量缓存访问DOM的样式信息，避免过度触发回流；")]),t._v(" "),a("li",[t._v("动画尽量使用绝对定位，或固定定位的元素上；或者是同tranform。")])]),t._v(" "),a("h3",{attrs:{id:"_7-tcp四次挥手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-tcp四次挥手"}},[t._v("#")]),t._v(" 7. TCP四次挥手")]),t._v(" "),a("p",[t._v("客户端请求断开连接时，有可能服务端资源还没有传输完毕。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("参考链接；")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("async vs defer attributes"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6928677404332425223",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里面试官的”说一下从url输入到返回请求的过程“问的难度就是不一样！"),a("OutboundLink")],1)])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"盒模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#盒模型"}},[t._v("#")]),t._v(" 盒模型")]),t._v(" "),a("ul",[a("li",[t._v("content-box：盒子的width和height 不包含padding和border")]),t._v(" "),a("li",[t._v("border-box：盒子的width和height 包含padding和border")])]),t._v(" "),a("h2",{attrs:{id:"css优先级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css优先级"}},[t._v("#")]),t._v(" CSS优先级")]),t._v(" "),a("p",[t._v("!important > style内联样式 > id > 类选择器、属性选择器、伪类选择器 > 标签选择器、伪元素")]),t._v(" "),a("h2",{attrs:{id:"重排和重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重排和重绘"}},[t._v("#")]),t._v(" 重排和重绘")]),t._v(" "),a("ul",[a("li",[t._v("重排：影响了元素的位置或者尺寸，浏览器需要重新计算元素在视口内的几何数学")]),t._v(" "),a("li",[t._v("重绘：样式改变并没有影响到元素的尺寸和位置。")])]),t._v(" "),a("p",[t._v("优化：")]),t._v(" "),a("ul",[a("li",[t._v("样式集中改变；")]),t._v(" "),a("li",[t._v("批量操作DOM；")]),t._v(" "),a("li",[t._v("脱离文档流；")]),t._v(" "),a("li",[t._v("开启GPU加速，不在主线程，在合成器线程渲染。")])]),t._v(" "),a("h2",{attrs:{id:"bfc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bfc"}},[t._v("#")]),t._v(" BFC")]),t._v(" "),a("p",[t._v("以下情况会创建BFC：")]),t._v(" "),a("ul",[a("li",[t._v("float浮动定位")]),t._v(" "),a("li",[t._v("绝对定位absolute、fixed")]),t._v(" "),a("li",[t._v("overflow不为visible")])]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("参考链接：")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6844903779700047885",target:"_blank",rel:"noopener noreferrer"}},[t._v("你真的了解回流和重绘吗"),a("OutboundLink")],1)])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"js基础类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js基础类型"}},[t._v("#")]),t._v(" js基础类型")]),t._v(" "),a("ul",[a("li",[t._v("BigInt：产生任意大的整数")]),t._v(" "),a("li",[t._v("Symbol：代表独一无二的值，可以用来定义对象的唯一属性名")])]),t._v(" "),a("h2",{attrs:{id:"instanceof"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#instanceof"}},[t._v("#")]),t._v(" instanceof")]),t._v(" "),a("p",[t._v("用来判断对象类型，不能判断基本类型；判断左边的对象是否为右边的实例对象，即判断左原型链上是否存在右边的原型上。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("myInstanceof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("right")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" leftVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrototypeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" rightVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leftVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leftVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" rightVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        leftVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" leftVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrototypeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leftVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("此外，"),a("code",[t._v("Obeject.prototype.toString.call()")]),t._v("可以判断所有原始数据类型。")]),t._v(" "),a("p",[t._v("扩展：如果判断变量是否为数组：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isArray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\narr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__proto__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype\narr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h2",{attrs:{id:"手写深拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手写深拷贝"}},[t._v("#")]),t._v(" 手写深拷贝")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("deepClone")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" map "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化返回结果")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// || 后面方式Array的prototype被重写")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[object Array]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 防止循环引用")]),t._v("\n    map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保证key不是原型属性")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasOwnProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归调用")]),t._v("\n            result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("deepClone")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回结果")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br")])]),a("h2",{attrs:{id:"_0-1-0-2-0-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-1-0-2-0-3"}},[t._v("#")]),t._v(" 0.1 + 0.2 !== 0.3")]),t._v(" "),a("p",[t._v("因为JS在做数字计算的时候，0.1和0.2都会被转为二进制后无限循环，js采用的IEEE754二进制浮点计算，最大可以存储53位有效数字，后面的都会被截取，导致精度丢失。")]),t._v(" "),a("p",[t._v("解决方法：")]),t._v(" "),a("ul",[a("li",[t._v("采用BigInt转成大数计算")]),t._v(" "),a("li",[t._v("使用Number.EPSILON误差范围,它是一个可以接受的最小误差范围，一般来说是Math.pow(2,-52)")])]),t._v(" "),a("h2",{attrs:{id:"原型与原型链"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原型与原型链"}},[t._v("#")]),t._v(" 原型与原型链")]),t._v(" "),a("p",[t._v("每个JavaScript对象在创建的时候，就会自动关联上另外一个对象，也就是原型，可以继承原型上的一些属性，即prototype对象；原型链则是创建的对象通过原型连接起来的一个结构。")]),t._v(" "),a("p",[t._v("两个概念：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("JS分为函数对象和普通对象，每个对象都有__proto__属性，但是只有函数对象才有prototype属性；")])]),t._v(" "),a("li",[a("p",[t._v("Object、Function都是JS内置的函数，类似的还有常见的Array、RegExp、Data、Boolean、Number、String")])]),t._v(" "),a("li",[a("p",[t._v("属性__proto__是一个对象，它有两个属性，constuctor和__proto__；")])]),t._v(" "),a("li",[a("p",[t._v("原型对象prototype有一个默认的constructor属性，用于记录实例是哪个构造函数创建的。")])])]),t._v(" "),a("p",[t._v("两个准则：")]),t._v(" "),a("ol",[a("li",[t._v("原型对象（Person.prototype）的constuctor指向构造函数本身；"),a("code",[t._v("Person.prototype.constructor == Person")])]),t._v(" "),a("li",[t._v("实例（即person01）的__proto__和原型对象指向同一个地方；person01."),a("strong",[t._v("proto")]),t._v(" == Person.prototype")])]),t._v(" "),a("h2",{attrs:{id:"作用域与作用域链"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用域与作用域链"}},[t._v("#")]),t._v(" 作用域与作用域链")]),t._v(" "),a("h3",{attrs:{id:"作用域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用域"}},[t._v("#")]),t._v(" 作用域")]),t._v(" "),a("p",[t._v("JS采用的是静态作用域，所以函数的作用域在函数定义时就确定了。")]),t._v(" "),a("p",[t._v("作用域最大的用处就是隔离变量，不同作用域下同名变量不会有冲突。ES6之前没有块级作用域，只有全局作用域和函数作用域。")]),t._v(" "),a("p",[t._v("全局作用域：")]),t._v(" "),a("ul",[a("li",[t._v("最外层函数、最外层函数外面定义的变量；")]),t._v(" "),a("li",[t._v("所有未定义直接赋值的变量自动声明为拥有全局作用域；")]),t._v(" "),a("li",[t._v("所有window对象的属性拥有全局作用域。")])]),t._v(" "),a("p",[t._v("缺点：如果定义的变量都没有用函数包括，全都会在全局作用域下，会污染全局命名空间，容易引起命名冲突。")]),t._v(" "),a("p",[t._v("函数作用域：声明在函数内部的变量，和全局作用域相反，函数作用域一般只在固定的代码片段内可访问到，比如函数内部。")]),t._v(" "),a("p",[t._v("作用域是分层的，内层作用域可以访问外层作用域的变量，反之则不行。")]),t._v(" "),a("p",[t._v("块级作用域：通过const和let声明，创建方式：")]),t._v(" "),a("ul",[a("li",[t._v("在一个函数内部")]),t._v(" "),a("li",[t._v("在一个代码块（由一对花括号包裹）内部。")])]),t._v(" "),a("p",[t._v("for循环有一个特别之处：设置循环变量的那部分是一个父作用域，而循环体内部是一个单独的子作用域。")]),t._v(" "),a("h3",{attrs:{id:"作用域链"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用域链"}},[t._v("#")]),t._v(" 作用域链")]),t._v(" "),a("p",[t._v("自由变量：当前作用域没有定义的变量；它的值需要向父级作用域寻找。具体一点来说，要到创建这个函数的那个域去找，注意是创建，而不是调用，这就是所谓的静态作用域。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("f")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//10，而不是20")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("再来看一个例子：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//30")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" bar\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("x")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//bar()")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("fn()返回的是bar函数，赋值给x；执行x()，即执行bar函数代码。取b值，直接在fn作用域取出；去a值，在fn作用域取不到3，从创建fn的那个作用域查找，拿到10.")]),t._v(" "),a("h2",{attrs:{id:"作用域与执行上下文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用域与执行上下文"}},[t._v("#")]),t._v(" 作用域与执行上下文")]),t._v(" "),a("p",[t._v("JavaScript属于解释性语言，JavaScript的执行分为：解释和执行两个阶段，这两个阶段所做的事并不一样：")]),t._v(" "),a("ul",[a("li",[t._v("解释阶段：")]),t._v(" "),a("li",[t._v("执行阶段：")])]),t._v(" "),a("p",[t._v("在解释阶段就已经确定了作用域规则，即函数定义的时候；而执行上下文是函数执行之前创建的。在执行上下文期间，this的指向是执行时确认的。")]),t._v(" "),a("p",[t._v("因此一个作用域下可能包含多个上下文环境；有可能从来就没有上下文环境；有可能有过，现在函数被调用完毕后，上下文环境被销毁了；有可能同时存在一个或多个（闭包）。总之，同一个作用域下，不同的调用会产生不同的执行上下文环境，继而产生不同的变量的值。")]),t._v(" "),a("h2",{attrs:{id:"立即执行函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#立即执行函数"}},[t._v("#")]),t._v(" 立即执行函数")]),t._v(" "),a("p",[t._v("立即执行函数常用于第三方库，可以用来隔离变量作用域，因为第三方库都会存在大量的变量和函数，为了避免变量污染。立即执行函数的代码，外部是无法访问的。因为在ES5的时候是没有块级作用域，立即执行函数它类似于函数声明，但是由于被包含在括号中，所以会被解释为函数表达式，紧跟在第一组括号后面的第二组括号会立即调用前面的函数表达式，就像是模拟的块级作用域。")]),t._v(" "),a("p",[t._v("此外，它可以防止变量定义外泄，因为不存在对这个匿名函数的引用，函数执行完毕之后，它的作用域链就可以被销毁。")]),t._v(" "),a("p",[t._v("常见的一个问题：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" liList "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    liList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为什么 alert 出来的总是 6，而不是 0、1、2、3、4、5")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("用户的点击一定是在for运行完了之后才点击的，此时候i为6；因为i是一个全局作用域的。那怎么解决呢？当然是给每个循环创建一个独立的作用域：")]),t._v(" "),a("ol",[a("li",[t._v("用立即执行函数给每个li创建一个独立作用域即可")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" liList "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ii")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      liList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ii"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ii"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("直接用let为每次循环创建子作用域")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" liList "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    liList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h2",{attrs:{id:"观察者模式-发布-订阅模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#观察者模式-发布-订阅模式"}},[t._v("#")]),t._v(" 观察者模式（发布-订阅模式）")]),t._v(" "),a("p",[t._v("思想：被观察对象（subject）维护一组观察者（observe），当被观察对象状态改变时，通过调用观察者的某个方法将这些变化通知到观察者。观察者模式一般需要实现：")]),t._v(" "),a("ul",[a("li",[t._v("subscribe():接收一个观察者observe对象，使其订阅自己")]),t._v(" "),a("li",[t._v("unsubscribe()：接收一个观察者observe对象，使其取消订阅自己；")]),t._v(" "),a("li",[t._v("fire():触发事件，通知到所有观察者。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Subject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("observers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("subscribe")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("observers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("observer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("unsubscribe")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("observerToRemove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("observers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("observers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("observer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" observer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" observerToRemove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fire")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("oberservers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("observer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("p",[t._v("Vue中的数据双向绑定就是通过观察者模式以及数据劫持实现的。首先通过ES5提供的Object.defineProperty()方法来劫持并监听各属性的getter和setter，并在监听的属性发生变动时候通知订阅者，是否需要更新，若更新的话就会执行对应的更新函数。")]),t._v(" "),a("p",[t._v("Vue3新特性：支持树摇；新增了setup生命周期函数，在beforeCreate之前执行；Proxy进行数据劫持；")]),t._v(" "),a("p",[t._v("比如说表单的v-model可以实现数据的双向绑定，"),a("code",[t._v('<input v-model="xxx">')]),t._v(",原理是`<input :value='xxx' @input='xxx=$event.target.value'>")])])}),[],!1,null,null,null);s.default=e.exports}}]);